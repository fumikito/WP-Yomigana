"use strict";tinymce.PluginManager.add("yomigana",function(m,e){function t(e,t){var o,n=e.selection.getNode();return n.nodeName==t.toUpperCase()?(o=document.createTextNode(n.innerHTML),e.dom.replace(o,n,!1)):0<e.selection.getContent().length&&(o=e.dom.create(t),e.dom.setHTML(o,e.selection.getContent()),e.selection.setNode(o)),o}m.addButton("dl",{image:WpYomigana.imageBase+"dl-2.png",type:"splitbutton",tooltip:WpYomigana.dl,stateSelector:"dl",menu:[{text:WpYomigana.dlToggle,data:"list"},{text:WpYomigana.dtToggle,data:"toggle"}],onselect:function(e){switch(e.control.settings.data){case"toggle":var t,o,n,a=m.selection.getNode(),i=m.dom.getParent(a,"dl");if(!i)return;if(m.dom.is(a,"dt"))t=a,o="dd";else if(m.dom.is(a,"dd"))t=a,o="dt";else if(n=m.dom.getParent(a,"dt",i))t=n,o="dd";else{if(!(n=m.dom.getParent(a,"dd",i)))return;t=n,o="dt"}m.dom.rename(t,o);break;default:m.execCommand("InsertDefinitionList")}},onclick:function(){m.execCommand("InsertDefinitionList")}}),m.addButton("small",{image:WpYomigana.imageBase+"small-2.png",tooltip:WpYomigana.small,stateSelector:"small",onClick:function(){t(m,"small")}}),m.addButton("cite",{image:WpYomigana.imageBase+"cite-2.png",tooltip:WpYomigana.cite,stateSelector:"cite",onClick:function(){t(m,"cite")}}),m.addButton("q",{image:WpYomigana.imageBase+"q-2.png",tooltip:WpYomigana.q,stateSelector:"q",onClick:function(){var i,e,t,o=m.selection.getNode(),d=!1,l="";l=m.dom.is(o,"q")?(i=o,jQuery(i).text()):(e=m.dom.getParent(o,"q"))?(i=e,jQuery(i).text()):(d=!0,m.selection.getContent()),t=m.dom.getAttrib(i,"cite",""),window.WpYomiganaHelper.q(WpYomigana.q,function(){jQuery(this).find("#citeText").val(l),jQuery(this).find("#citeFrom").val(t)},function(e,t){switch(t){case"set":var o=e.find("#citeText").val(),n=e.find("#citeFrom").val();if(d){var a=document.createElement("q");a.appendChild(document.createTextNode(o)),a.cite=n,m.selection.setNode(a)}else m.dom.setAttrib(i,"cite",n);break;case"remove":d||m.dom.replace(document.createTextNode(l),i,!1)}})}}),m.addButton("ruby",{image:WpYomigana.imageBase+"ruby-2.png",tooltip:WpYomigana.ruby,stateSelector:"ruby",onClick:function(){var d,e,t,o=m.selection.getNode(),l=!1,c="",r=!1;c=m.dom.is(o,"ruby")?(d=o).firstChild.nodeValue:(e=m.dom.getParent(o,"ruby"))?(d=e).firstChild.nodeValue:(l=!0,m.selection.getContent()),t=m.dom.select("rt",d),d&&t&&(r=t[0]),window.WpYomiganaHelper.ruby(WpYomigana.ruby,function(){jQuery(this).find("#rubyBody").val(c),jQuery(this).find("#rubyText").val(r?r.firstChild.nodeValue:"")},function(e,t){switch(t){case"set":var o=e.find("#rubyBody").val(),n=e.find("#rubyText").val();if(l){var a=document.createElement("ruby");a.appendChild(document.createTextNode(o));var i=document.createElement("rt");i.appendChild(document.createTextNode(n)),a.appendChild(i),m.selection.setNode(a)}else d.firstChild.nodeValue=o,r.firstChild.nodeValue=n;break;case"remove":l||m.dom.replace(document.createTextNode(c),d,!1)}})}})});
//# sourceMappingURL=map/editor_plugin.js.map
