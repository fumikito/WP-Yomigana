"use strict";tinymce.PluginManager.add("yomigana",function(m,e){function t(e,t){var o=e.selection.getNode(),i=void 0;return o.nodeName==t.toUpperCase()?(i=document.createTextNode(o.innerHTML),e.dom.replace(i,o,!1)):0<e.selection.getContent().length&&(i=e.dom.create(t),e.dom.setHTML(i,e.selection.getContent()),e.selection.setNode(i)),i}m.addButton("dl",{image:WpYomigana.imageBase+"dl-2.png",type:"splitbutton",tooltip:WpYomigana.dl,stateSelector:"dl",menu:[{text:WpYomigana.dlToggle,data:"list"},{text:WpYomigana.dtToggle,data:"toggle"}],onselect:function(e){switch(e.control.settings.data){case"toggle":var t=m.selection.getNode(),o=m.dom.getParent(t,"dl"),i=void 0,n=void 0,a=void 0;if(!o)return;if(m.dom.is(t,"dt"))i=t,n="dd";else if(m.dom.is(t,"dd"))i=t,n="dt";else if(a=m.dom.getParent(t,"dt",o))i=a,n="dd";else{if(!(a=m.dom.getParent(t,"dd",o)))return;i=a,n="dt"}m.dom.rename(i,n);break;default:m.execCommand("InsertDefinitionList")}},onclick:function(){m.execCommand("InsertDefinitionList")}}),m.addButton("small",{image:WpYomigana.imageBase+"small-2.png",tooltip:WpYomigana.small,stateSelector:"small",onClick:function(){t(m,"small")}}),m.addButton("cite",{image:WpYomigana.imageBase+"cite-2.png",tooltip:WpYomigana.cite,stateSelector:"cite",onClick:function(){t(m,"cite")}}),m.addButton("q",{image:WpYomigana.imageBase+"q-2.png",tooltip:WpYomigana.q,stateSelector:"q",onClick:function(){var e,t=m.selection.getNode(),a=!1,d="",l=void 0,o=void 0;m.dom.is(t,"q")?(l=t,d=jQuery(l).text()):(o=m.dom.getParent(t,"q"))?(l=o,d=jQuery(l).text()):(a=!0,d=m.selection.getContent()),e=m.dom.getAttrib(l,"cite",""),window.WpYomiganaHelper.q(WpYomigana.q,function(){jQuery(this).find("#citeText").val(d),jQuery(this).find("#citeFrom").val(e)},function(e,t){switch(t){case"set":var o=e.find("#citeText").val(),i=e.find("#citeFrom").val();if(a){var n=document.createElement("q");n.appendChild(document.createTextNode(o)),n.cite=i,m.selection.setNode(n)}else m.dom.setAttrib(l,"cite",i);break;case"remove":a||m.dom.replace(document.createTextNode(d),l,!1)}})}}),m.addButton("ruby",{image:WpYomigana.imageBase+"ruby-2.png",tooltip:WpYomigana.ruby,stateSelector:"ruby",onClick:function(){var e,t=m.selection.getNode(),d=!1,l="",c=void 0,o=void 0,r=!1;m.dom.is(t,"ruby")?l=(c=t).firstChild.nodeValue:(o=m.dom.getParent(t,"ruby"))?l=(c=o).firstChild.nodeValue:(d=!0,l=m.selection.getContent()),e=m.dom.select("rt",c),c&&e&&(r=e[0]),window.WpYomiganaHelper.ruby(WpYomigana.ruby,function(){jQuery(this).find("#rubyBody").val(l),jQuery(this).find("#rubyText").val(r?r.firstChild.nodeValue:"")},function(e,t){switch(t){case"set":var o=e.find("#rubyBody").val(),i=e.find("#rubyText").val();if(d){var n=document.createElement("ruby");n.appendChild(document.createTextNode(o));var a=document.createElement("rt");a.appendChild(document.createTextNode(i)),n.appendChild(a),m.selection.setNode(n)}else c.firstChild.nodeValue=o,r.firstChild.nodeValue=i;break;case"remove":d||m.dom.replace(document.createTextNode(l),c,!1)}})}})});
//# sourceMappingURL=map/editor_plugin.js.map
